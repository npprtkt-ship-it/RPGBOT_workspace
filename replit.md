# Discord RPG Bot（日本語版）

## プロジェクト概要
Discord上で動作する日本語RPGボットです。ターン制バトル、ダンジョン探索、アイテム管理、レベルアップシステムを備えています。

## 最新の変更履歴（2025年11月1日）
### モンスター行動確率システムの実装
- **game.py**: 全モンスター用のスキルデータベース（MONSTER_SKILLS）を追加
- **game.py**: 確率ベース行動決定関数（get_monster_action）を実装
  - 通常戦闘: スキル20% / 通常攻撃50% / 待機20% / 逃走10%
  - ボス戦: スキル40% / 通常攻撃50% / 待機10% / 逃走0%
- **game.py**: スキルダメージ計算関数（calculate_skill_damage）を追加
- **views.py**: BattleViewとBossBattleViewを確率ベースシステムに更新
- 各行動の戦闘ログメッセージを実装（スキル名、効果説明、待機、逃走など）

## プロジェクト構成
```
/
├── main.py          # Discord Bot メインエントリーポイント
├── game.py          # ゲームロジック（バトル、スキル、確率システムなど）
├── views.py         # Discord UI（ボタン、バトルビュー、メニューなど）
├── db.py            # データベース操作（Supabase）
├── config.py        # 環境変数読み込み
└── requirements.txt # Python依存関係
```

## 技術スタック
- **言語**: Python 3.11
- **フレームワーク**: discord.py (2.3.2+)
- **データベース**: Supabase (PostgreSQL)
- **環境変数管理**: python-dotenv

## 必要な環境変数
このボットを実行するには、以下の環境変数（シークレット）が必要です：

1. **DISCORD_TOKEN** - Discord Botのトークン（Discord Developer Portalから取得）
2. **SUPABASE_URL** - Supabaseプロジェクトの URL
3. **SUPABASE_KEY** - Supabaseのanon/publicキー

これらの環境変数は、Replitの「Secrets」タブから設定してください。

## ゲーム機能
- **バトルシステム**: ターン制戦闘、スキル使用、通常攻撃
- **モンスターAI**: 確率ベースの行動パターン（スキル、攻撃、待機、逃走）
- **ダンジョン探索**: 異世界ダンジョンでの冒険
- **アイテムシステム**: 装備、消費アイテム、インベントリ管理
- **成長システム**: レベルアップ、ステータス振り分け
- **ボス戦**: 特別な行動パターンを持つボスモンスター

## 開発ガイドライン
- **日本語対応**: すべてのメッセージ、UI、ログは日本語で表示
- **確率システム**: モンスターの行動は確率ベースで決定
- **データ整合性**: Supabaseでプレイヤーデータを永続化
- **Discord UX**: ボタンインタラクション、Embed表示で視覚的に分かりやすく

## デバッグ情報
- ワークフロー名: `Discord RPG Bot`
- 実行コマンド: `python main.py`
- ログは `/tmp/logs/` に出力されます
